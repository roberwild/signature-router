<?xml version="1.0" encoding="UTF-8"?>
<story-context id="signature-router-10-12-context" version="1.0">
  <metadata>
    <epicId>10</epicId>
    <storyId>10.12</storyId>
    <storyKey>10-12-todo-cleanup</storyKey>
    <title>TODO Cleanup - Inventario y Catalogación de Deuda Técnica</title>
    <status>ready-for-dev</status>
    <generatedAt>2025-11-29</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/10-12-todo-cleanup.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>Development Team</asA>
    <iWant>Inventario completo de TODOs y deuda técnica</iWant>
    <soThat>Podamos priorizar y planificar trabajo futuro</soThat>
    
    <context>
      Esta story cataloga y organiza todos los comentarios TODO y código temporal en el proyecto. 
      La evaluación de calidad identificó múltiples TODOs sin tickets asociados y código marcado 
      como "TEMPORARY" sin decisión sobre su futuro.
      
      Source: Evaluación de Calidad identificó TODOs sin tickets y código temporal.
      
      Business Value: Visibilidad completa de deuda técnica, priorización clara de trabajo futuro, 
      prevención de código temporal quedándose en producción, mejora mantenibilidad del código.
    </context>

    <tasks>
      <task id="1" ac="AC1">
        <title>Search All TODOs</title>
        <subtasks>
          <subtask id="1.1">Ejecutar grep -r "TODO" src/ para encontrar todos los TODOs</subtask>
          <subtask id="1.2">Ejecutar grep -r "FIXME|XXX|HACK" src/ para otros marcadores</subtask>
          <subtask id="1.3">Ejecutar grep -r "TEMPORARY|Temporary" src/ para código temporal</subtask>
          <subtask id="1.4">Guardar resultados en archivos temporales</subtask>
        </subtasks>
      </task>
      
      <task id="2" ac="AC1,AC2">
        <title>Create Inventory File</title>
        <subtasks>
          <subtask id="2.1">Crear tech-debt-inventory.txt</subtask>
          <subtask id="2.2">Para cada TODO encontrado: extraer ubicación, contexto, categorizar, priorizar</subtask>
          <subtask id="2.3">Determinar si es válido u obsoleto</subtask>
          <subtask id="2.4">Organizar por categoría y prioridad</subtask>
        </subtasks>
        <filesToCreate>
          <file>tech-debt-inventory.txt</file>
        </filesToCreate>
      </task>
      
      <task id="3" ac="AC4">
        <title>Review and Validate TODOs</title>
        <subtasks>
          <subtask id="3.1">Revisar cada TODO manualmente</subtask>
          <subtask id="3.2">Determinar si es válido u obsoleto</subtask>
          <subtask id="3.3">Para obsoletos: marcar para eliminación</subtask>
          <subtask id="3.4">Para válidos: preparar para crear tickets</subtask>
        </subtasks>
      </task>
      
      <task id="4" ac="AC3">
        <title>Create GitHub Issues</title>
        <subtasks>
          <subtask id="4.1">Para cada TODO válido: crear GitHub issue con template</subtask>
          <subtask id="4.2">Asignar labels apropiados</subtask>
          <subtask id="4.3">Asignar prioridad</subtask>
          <subtask id="4.4">Link a código fuente</subtask>
          <subtask id="4.5">Documentar issues creados en inventario</subtask>
        </subtasks>
      </task>
      
      <task id="5" ac="AC4">
        <title>Remove Obsolete TODOs</title>
        <subtasks>
          <subtask id="5.1">Para cada TODO obsoleto: eliminar del código</subtask>
          <subtask id="5.2">Commit con mensaje explicativo</subtask>
          <subtask id="5.3">Actualizar inventario marcando como eliminados</subtask>
        </subtasks>
      </task>
      
      <task id="6" ac="AC5">
        <title>Decision on Temporary Code</title>
        <subtasks>
          <subtask id="6.1">Revisar cada pieza de código marcada como TEMPORARY</subtask>
          <subtask id="6.2">Para cada una, decidir: Keep, Replace, o Remove</subtask>
          <subtask id="6.3">Documentar decisiones en inventario</subtask>
        </subtasks>
      </task>
      
      <task id="7" ac="AC6">
        <title>Prioritize Backlog</title>
        <subtasks>
          <subtask id="7.1">Revisar todos los tickets creados</subtask>
          <subtask id="7.2">Asignar prioridad (P0/P1/P2/P3)</subtask>
          <subtask id="7.3">Agregar estimaciones si posible</subtask>
          <subtask id="7.4">Organizar en milestones si aplica</subtask>
        </subtasks>
      </task>
      
      <task id="8" ac="AC7">
        <title>Create TECH-DEBT.md</title>
        <subtasks>
          <subtask id="8.1">Crear TECH-DEBT.md con resumen ejecutivo</subtask>
          <subtask id="8.2">Incluir estadísticas (total TODOs, por categoría, por prioridad)</subtask>
          <subtask id="8.3">Incluir timeline estimado</subtask>
          <subtask id="8.4">Incluir owners si asignados</subtask>
        </subtasks>
        <filesToCreate>
          <file>TECH-DEBT.md</file>
        </filesToCreate>
      </task>
    </tasks>
  </story>

  <acceptanceCriteria>
    <criterion id="AC1">
      <title>TODO Inventory Created</title>
      <given>Código base</given>
      <when>Ejecuto búsqueda de TODOs</when>
      <then>
        Se crea archivo tech-debt-inventory.txt con:
        - Lista completa de todos los TODOs encontrados
        - Ubicación (archivo, línea)
        - Contexto (código alrededor)
        - Prioridad (Crítico/Importante/Bajo)
        - Categoría (Security/Performance/Refactoring/etc.)
      </then>
      <verification>Archivo existe y contiene todos los TODOs</verification>
    </criterion>

    <criterion id="AC2">
      <title>TODOs Categorized</title>
      <given>tech-debt-inventory.txt</given>
      <when>Reviso inventario</when>
      <then>
        Cada TODO está categorizado:
        - Security: Vulnerabilidades o riesgos de seguridad
        - Performance: Optimizaciones de performance
        - Refactoring: Mejoras de código sin cambio funcional
        - Feature: Features futuras o mejoras funcionales
        - Documentation: Documentación faltante
        - Testing: Tests faltantes o mejoras de testing
      </then>
      <verification>Todos los TODOs tienen categoría asignada</verification>
    </criterion>

    <criterion id="AC3">
      <title>Tickets Created for Valid TODOs</title>
      <given>TODOs válidos (no obsoletos)</given>
      <when>Reviso backlog</when>
      <then>
        Se crean tickets (GitHub issues) para cada TODO válido con:
        - Título descriptivo
        - Descripción con contexto
        - Prioridad
        - Labels apropiados
        - Link a código fuente
      </then>
      <verification>Tickets creados en GitHub</verification>
    </criterion>

    <criterion id="AC4">
      <title>Obsolete TODOs Removed</title>
      <given>TODOs obsoletos</given>
      <when>Reviso código</when>
      <then>
        TODOs obsoletos son eliminados del código con commit message 
        explicando por qué
      </then>
      <verification>grep no encuentra TODOs obsoletos</verification>
    </criterion>

    <criterion id="AC5">
      <title>Temporary Code Decision</title>
      <given>Código marcado como "TEMPORARY"</given>
      <when>Reviso inventario</when>
      <then>
        Se toma decisión para cada pieza:
        - Keep: Mantener código (remover marca TEMPORARY)
        - Replace: Plan para reemplazar con implementación real
        - Remove: Eliminar código si ya no es necesario
      </then>
      <verification>Decisiones documentadas en inventario</verification>
    </criterion>

    <criterion id="AC6">
      <title>Backlog Prioritized</title>
      <given>Tickets creados</given>
      <when>Reviso backlog</when>
      <then>
        Tickets están priorizados:
        - P0 (Critical): Bloquea producción o seguridad
        - P1 (High): Importante para calidad o performance
        - P2 (Medium): Mejoras importantes pero no críticas
        - P3 (Low): Nice to have
      </then>
      <verification>Todos los tickets tienen prioridad asignada</verification>
    </criterion>

    <criterion id="AC7">
      <title>Documentation Updated</title>
      <given>Inventario completado</given>
      <when>Reviso documentación</when>
      <then>
        TECH-DEBT.md creado con:
        - Resumen de deuda técnica
        - Priorización
        - Timeline estimado para resolver
        - Owners asignados (si aplica)
      </then>
      <verification>TECH-DEBT.md existe y está completo</verification>
    </criterion>
  </acceptanceCriteria>

  <technicalNotes>
    <note>
      Búsqueda de TODOs puede usar grep o herramientas de IDE. Considerar usar 
      script automatizado para generar inventario inicial.
    </note>
    <note>
      Categorización puede requerir conocimiento del contexto. Revisar manualmente 
      cada TODO para categorización precisa.
    </note>
    <note>
      Código TEMPORARY puede tener dependencias. Revisar dependencias antes de eliminar, 
      crear plan de migración si necesario.
    </note>
  </technicalNotes>

  <dependencies>
    <internal>
      <prerequisite>Código base existente con TODOs y código temporal</prerequisite>
    </internal>
    <external>
      <tool>
        <name>grep</name>
        <reason>Búsqueda de TODOs en código</reason>
      </tool>
      <tool>
        <name>GitHub</name>
        <reason>Creación de issues/tickets</reason>
      </tool>
    </external>
  </dependencies>

  <testStrategy>
    <verification>
      Ejecutar búsqueda de TODOs y verificar que todos están en inventario
      Verificar que tickets creados tienen links correctos
      Verificar que código obsoleto fue eliminado
    </verification>
  </testStrategy>

  <risks>
    <risk>
      <description>Inventario puede ser muy grande y difícil de manejar</description>
      <mitigation>Organizar por categoría y prioridad, usar milestones en GitHub</mitigation>
    </risk>
    <risk>
      <description>Algunos TODOs pueden ser ambiguos</description>
      <mitigation>Revisar manualmente, pedir clarificación al autor original si posible</mitigation>
    </risk>
    <risk>
      <description>Código TEMPORARY puede tener dependencias</description>
      <mitigation>Revisar dependencias antes de eliminar, crear plan de migración si necesario</mitigation>
    </risk>
  </risks>

  <references>
    <reference>Epic 10 Tech Spec: docs/sprint-artifacts/tech-spec-epic-10.md</reference>
    <reference>Quality Evaluation: Evaluación_de_Calidad_del_Proyecto_Signature_Router.md</reference>
  </references>
</story-context>
